name: render_deploy
true:
  workflow_dispatch: null
  push:
    branches:
    - main
jobs:
  precheck:
    runs-on: ubuntu-latest
    outputs:
      ok: ${{ steps.p.outputs.ok }}
    steps:
    - uses: actions/checkout@v4
    - id: p
      uses: ./.github/actions/precheck
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: Validate secret
      run: "if [ -z \"${{ secrets.RENDER_DEPLOY_HOOK }}\" ]; then\n  echo \"\u274C\
        \ Missing secret: RENDER_DEPLOY_HOOK\" && exit 1\nfi\n"
    - name: Trigger Render Deploy
      run: "curl -fsS -X POST \"${{ secrets.RENDER_DEPLOY_HOOK }}\" \\\n&& echo \"\
        \u2705 Render deploy triggered\"\n"
    needs: precheck
    if: ${{ needs.precheck.outputs.ok == 'true' && github.ref == 'refs/heads/main'
      }}
